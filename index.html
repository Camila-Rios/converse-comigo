<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chat - Pr√©via Privada (Simulador WhatsApp)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Base */
    :root{
      --wa-green:#25D366;
      --wa-dark:#0b3b2e;
      --bubble-me:#dcf8c6;
      --bubble-her:#ffffff18;
      --bg:#e9edef;
    }
    html,body{height:100%;}
    body{background:linear-gradient(180deg,#071322 0%,#021018 100%);font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;}

    /* Container */
    .frame{width:100%;max-width:420px;height:92vh;border-radius:18px;overflow:hidden;box-shadow:0 30px 60px rgba(2,6,23,.6);border:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg,#001b17,#063031);display:flex;flex-direction:column}

    /* Top bar - WhatsApp style */
    .top{display:flex;align-items:center;gap:12px;padding:12px 14px;background:linear-gradient(90deg,var(--wa-dark),#073b2e);color:#fff}
    .avatar{width:44px;height:44px;border-radius:50%;overflow:hidden;border:2px solid rgba(255,255,255,.08)}
    .top .meta{line-height:1}
    .top .meta .name{font-weight:600}
    .top .meta .status{font-size:12px;opacity:.9}

    /* Messages area */
    .messages{flex:1;padding:16px;overflow:auto;background-image:linear-gradient(to bottom, rgba(255,255,255,0.01), rgba(255,255,255,0.005));backdrop-filter: blur(0.6px)}

    .msg-row{display:flex;margin-bottom:10px;align-items:flex-end}
    .msg-row.me{justify-content:flex-end}
    .bubble{display:inline-block;padding:10px 14px;border-radius:18px;max-width:78%;line-height:1.3;font-size:14px;box-shadow:0 2px 0 rgba(0,0,0,0.06);position:relative}
    .bubble.me{background:var(--bubble-me);color:#0b3b2e;border-bottom-right-radius:6px}
    .bubble.her{background:rgba(255,255,255,0.08);color:#fff;border-bottom-left-radius:6px}
    .bubble img{border-radius:12px;display:block}

    .time{font-size:11px;opacity:.6;margin-left:8px}

    /* Typing */
    .typing{display:flex;align-items:center;gap:6px;padding:8px 10px;border-radius:18px;background:rgba(255,255,255,0.06);width:120px}
    .dot{width:6px;height:6px;background:#fff;border-radius:50%;opacity:.9;animation:blink 1.2s infinite}
    .dot:nth-child(2){animation-delay:.15s}
    .dot:nth-child(3){animation-delay:.3s}
    @keyframes blink{0%{transform:translateY(0);opacity:.25}50%{transform:translateY(-4px);opacity:1}100%{transform:translateY(0);opacity:.25}}

    /* Composer */
    .composer{display:flex;gap:10px;padding:12px;background:linear-gradient(180deg,rgba(0,0,0,0.25),rgba(255,255,255,0.02));align-items:center}
    .fake-input{flex:1;background:#0b2b24;color:#fff;padding:10px 12px;border-radius:999px;border:1px solid rgba(255,255,255,0.03);font-size:14px}
    .btn{padding:9px 14px;border-radius:999px;font-weight:600}
    .btn-primary{background:var(--wa-green);color:#06331f}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:#fff}

    /* Modal (glass) */
    .modal-wrap{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:60}
    .modal{width:100%;max-width:880px;background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));border-radius:14px;padding:14px;border:1px solid rgba(255,255,255,0.04);backdrop-filter: blur(6px)}
    .modal-grid{display:grid;grid-template-columns:1fr 360px;gap:14px}
    .preview-img{width:100%;height:100%;object-fit:cover;border-radius:10px}

    /* PIX card */
    .pix-card{padding:12px;border-radius:10px;background:rgba(0,0,0,0.35);border:1px solid rgba(255,255,255,0.04)}
    .pix-qr{width:150px;height:150px;border-radius:8px;background:rgba(255,255,255,0.02);display:block}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, monospace}

    /* small responsive */
    @media (max-width:880px){
      .modal-grid{grid-template-columns:1fr}
      .frame{max-width:100%;height:92vh}
    }

    /* subtle entry animation for bubbles */
    .bubble{transform:translateY(6px);opacity:0;animation:enter .28s forwards}
    @keyframes enter{to{transform:none;opacity:1}}

  </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

  <div class="frame" role="region" aria-label="Simulador WhatsApp - Pr√©via VIP">
    <!-- Top -->
    <div class="top">
      <div class="avatar"><img id="modelAvatarTop" src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=200&auto=format&fit=crop&crop=faces" alt="Camila" class="w-full h-full object-cover"></div>
      <div class="meta">
        <div class="name">Camila ‚ú®</div>
        <div class="status">online ‚Ä¢ √∫ltima vez h√° 2 min</div>
      </div>
      <div class="ml-auto text-right">
        <div class="text-xs text-white/90">VIP ‚Ä¢ R$19,90</div>
        <button id="openPreviewBtn" class="mt-2 btn btn-ghost text-xs">Pr√©via</button>
      </div>
    </div>

    <!-- Messages -->
    <div id="messages" class="messages" aria-live="polite"></div>

    <!-- Composer -->
    <div class="composer">
      <button id="playAudio" class="btn btn-ghost" aria-label="Tocar √°udio">‚ñ∂Ô∏è √Åudio</button>
      <input id="fakeInput" class="fake-input" placeholder="Escreva uma mensagem..." readonly aria-hidden="true">
      <button id="startPixFlow" class="btn btn-primary">Quero VIP</button>
    </div>
  </div>

  <!-- Modal (hidden by default) -->
  <div id="modal" class="modal-wrap hidden" role="dialog" aria-modal="true" aria-label="Pr√©via e pagamento">
    <div class="modal">
      <div class="flex items-center justify-between mb-3">
        <div class="flex items-center gap-3">
          <div class="avatar" style="width:44px;height:44px"><img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=200&auto=format&fit=crop&crop=faces" alt="Camila" class="w-full h-full object-cover rounded-full"></div>
          <div>
            <div class="font-semibold">Camila</div>
            <div class="text-xs text-white/80">Pr√©via escolhida a dedo</div>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button id="closeModal" class="btn btn-ghost">Fechar</button>
        </div>
      </div>

      <div class="modal-grid">
        <div class="rounded overflow-hidden">
          <img id="previewImage" src="https://images.unsplash.com/photo-1517841905240-472988babdf9?q=80&w=800&auto=format&fit=crop" alt="Pr√©via" class="preview-img">
        </div>

        <div class="flex flex-col gap-3">
          <div class="pix-card">
            <div class="flex items-center justify-between">
              <div>
                <div class="font-semibold">Pagar via PIX (recomendado)</div>
                <div class="text-xs text-white/80">R$19,90 ‚Ä¢ chave √∫nica gerada</div>
              </div>
              <div class="text-xs text-white/70">Seguro ‚Ä¢ Instant√¢neo</div>
            </div>

            <div class="mt-3 flex gap-3 items-start">
              <img id="pixQR" src="" alt="QR PIX" class="pix-qr" />
              <div class="flex-1">
                <div class="text-xs text-white/80">Chave PIX</div>
                <div id="pixKey" class="mono break-words text-sm mt-1 text-white">--</div>

                <div class="mt-3 flex gap-2">
                  <button id="copyKey" class="btn btn-ghost">Copiar</button>
                  <a id="downloadQR" download="pix-qr.png" class="btn btn-ghost" role="button">Baixar QR</a>
                </div>

                <div class="mt-3">
                  <button id="paidBtn" class="btn btn-primary">J√° paguei</button>
                  <button id="noPixBtn" class="btn btn-ghost ml-2">N√£o tenho PIX</button>
                </div>

                <div id="pixStatus" class="text-xs text-white/70 mt-3">Status: aguardando pagamento...</div>
              </div>
            </div>

          </div>

          <div class="text-xs text-white/80">Se n√£o conseguir pagar com PIX, finalize no checkout:</div>
          <a id="checkoutLink" href="#" class="btn btn-primary text-sm inline-block">Ir para checkout</a>

        </div>
      </div>

    </div>
  </div>

  <!-- Hidden audio element -->
  <audio id="modelAudio" src="https://www.w3schools.com/html/horse.mp3"></audio>

<script>
// --- Dados de demonstra√ß√£o (troque conforme necess√°rio) ---
const messagesData = [
  {from:'her', text:'Oi, amorzinho üòò j√° escolhi a pr√©via perfeita pra voc√™.'},
  {from:'her', text:'T√° afim de ver agora mesmo? Posso liberar por R$19,90.'},
  {from:'her', text:'Se quiser posso mandar um √°udio exclusivo tamb√©m.'},
  {from:'me', text:'Quero ver agora.'}
];

const messagesEl = document.getElementById('messages');
let idx = 0;

function createRow(from){
  const row = document.createElement('div');
  row.className = 'msg-row ' + (from==='me' ? 'me' : '');
  return row;
}

function appendBubble(from, html, opts={time:true}){
  const row = createRow(from);
  const bubble = document.createElement('div');
  bubble.className = 'bubble ' + (from==='me'? 'me':'' ) + (from==='her' ? ' her':'');
  bubble.innerHTML = html;

  // timestamp
  if(opts.time){
    const t = document.createElement('div');
    t.className = 'time';
    const now = new Date();
    t.textContent = now.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
    bubble.appendChild(t);
  }

  row.appendChild(bubble);
  messagesEl.appendChild(row);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function showTyping(){
  const row = createRow('her');
  const t = document.createElement('div');
  t.className = 'typing';
  t.innerHTML = '<div class="dot"></div><div class="dot"></div><div class="dot"></div>';
  row.appendChild(t);
  messagesEl.appendChild(row);
  messagesEl.scrollTop = messagesEl.scrollHeight;
  return row;
}

function runSequence(){
  if(idx >= messagesData.length) return;
  const item = messagesData[idx++];
  const typingEl = showTyping();
  const delay = 700 + Math.random()*1300;
  setTimeout(()=>{
    typingEl.remove();
    appendBubble(item.from, item.text);
    if(idx === messagesData.length){
      setTimeout(()=> document.getElementById('openPreviewBtn').click(), 700);
    }
    runSequence();
  }, delay);
}

runSequence();

// --- Modal flow ---
const modal = document.getElementById('modal');
const openPreviewBtn = document.getElementById('openPreviewBtn');
const closeModal = document.getElementById('closeModal');
openPreviewBtn.addEventListener('click', ()=>{
  modal.classList.remove('hidden');
  generatePIX();
});
closeModal.addEventListener('click', ()=> modal.classList.add('hidden'));

// --- Audio ---
const audio = document.getElementById('modelAudio');
const playAudio = document.getElementById('playAudio');
playAudio.addEventListener('click', ()=>{ audio.play(); playAudio.blur(); });

// --- PIX generation ---
function generateRandomKey(){
  const names = ['camila.vip','camila.exclusiva','contato.camila','camila.oficial'];
  return names[Math.floor(Math.random()*names.length)] + (Math.floor(Math.random()*900)+100) + '@exemplo.com';
}

function buildPixPayload(key, amount, txid){
  // Simples; para produ√ß√£o use payload EMV ou gateway
  return `PAY?key=${key}&amount=${amount}&txid=${txid}`;
}

const pixKeyEl = document.getElementById('pixKey');
const pixQREl = document.getElementById('pixQR');
const downloadQR = document.getElementById('downloadQR');
let currentPixKey = '';
let currentTxId = '';

function generatePIX(){
  const key = generateRandomKey();
  const amount = '19.90';
  const txid = 'VIP' + Math.floor(Math.random()*900000+100000);
  currentPixKey = key;
  currentTxId = txid;
  pixKeyEl.textContent = key;
  const payload = buildPixPayload(key, amount, txid);
  const qrUrl = 'https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=' + encodeURIComponent(payload);
  pixQREl.src = qrUrl;
  downloadQR.href = qrUrl;
}

// Copy key
const copyKeyBtn = document.getElementById('copyKey');
copyKeyBtn.addEventListener('click', ()=>{
  navigator.clipboard.writeText(currentPixKey).then(()=>{
    toast('Chave PIX copiada');
  }).catch(()=>{ toast('N√£o foi poss√≠vel copiar'); });
});

// Paid button (simula√ß√£o)
const pixStatus = document.getElementById('pixStatus');
const paidBtn = document.getElementById('paidBtn');
paidBtn.addEventListener('click', ()=>{
  pixStatus.textContent = 'Verificando pagamento...';
  setTimeout(()=>{
    const paid = Math.random() < 0.62; // 62% chance
    if(paid){
      pixStatus.textContent = 'Pagamento confirmado ‚úÖ Liberando pr√©via...';
      setTimeout(()=>{
        appendBubble('her','Prontinho, amor! Aqui est√° a pr√©via exclusiva ‚ù§Ô∏è');
        appendBubble('her', '<img src="https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?q=80&w=600&auto=format&fit=crop" class="rounded max-w-full"/>');
        modal.classList.add('hidden');
      },700);
    } else {
      pixStatus.textContent = 'Pagamento n√£o encontrado. Voc√™ pode finalizar no checkout.';
      document.getElementById('checkoutLink').classList.remove('hidden');
    }
  },1200);
});

// No PIX -> checkout
const noPixBtn = document.getElementById('noPixBtn');
noPixBtn.addEventListener('click', ()=>{
  const checkoutUrl = 'https://seu-checkout-exemplo.com/checkout?product=vip19_90';
  window.open(checkoutUrl,'_blank');
});

// Checkout link
document.getElementById('checkoutLink').href = 'https://seu-checkout-exemplo.com/checkout?product=vip19_90';

// Small toast helper
function toast(text){
  const t = document.createElement('div');
  t.textContent = text;
  t.style.position='fixed';
  t.style.left='50%'; t.style.transform='translateX(-50%)';
  t.style.bottom='28px'; t.style.padding='10px 14px'; t.style.borderRadius='999px';
  t.style.background='rgba(0,0,0,0.6)'; t.style.color='#fff'; t.style.zIndex=9999; t.style.fontSize='13px';
  document.body.appendChild(t);
  setTimeout(()=> t.style.opacity = '0',1800);
  setTimeout(()=> t.remove(),2300);
}

</script>
</body>
</html>
